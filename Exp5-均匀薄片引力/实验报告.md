# 方形金属板引力计算与分析实验报告


## 1. 实验目的

1.  理解并计算均匀方形金属板对其中心轴线上方质点产生的万有引力。
2.  通过编程实现自定义的二维高斯-勒让德数值积分方法，用于计算引力公式中的二重积分。
3.  使用 `scipy.integrate.dblquad` 作为参考，对比和验证自定义积分方法的准确性。
4.  分析并解释在质点距离金属板极近 ($z \to 0^+$) 时，数值计算可能出现的误差现象及其产生原因。
5.  尝试提出并验证至少一种方法，以减弱或部分消除在 $z$ 值极小时的数值计算误差。
6.  绘制引力大小 $F_z$ 随距离 $z$ 变化的曲线，并与理论预期进行比较。

## 2. 实验原理与方法

**2.1 万有引力公式:**

一块边长为 $L$、总质量为 $M_{plate}$ 的均匀正方形金属板，其面密度为 $\sigma = M_{plate}/L^2$。在其中心垂直正上方距离 $z$ 处，一个质量为 $m_{particle}=1~\text{kg}$ 的质点所受的万有引力沿 $z$ 轴方向的分量 $F_z$ 可以表示为：

$$
F_z(z) = G \sigma m_{particle} z \iint_{-L/2}^{L/2} \frac{dx ~ dy}{(x^2+y^2+z^2)^{3/2}}
$$

其中 $G = 6.674 \times 10^{-11} ~ \text{m}^3 ~ \text{kg}^{-1} ~ \text{s}^{-2}$ 是万有引力常数。

**2.2 理论极限 (当 $z \to 0^+$):**

当质点无限接近一个无限大薄板的中心时 ($z \to 0^+$ 且 $z \ll L$)，引力理论上趋近于：

$$ F_{z,limit} = 2\pi G \sigma m_{particle} $$

这个值可以作为 $z$ 非常小时计算结果的一个参考。

**2.3 数值积分方法:**

**2.3.1 自定义二维高斯-勒让德求积:**

二重积分 $I(z) = \iint_{-L/2}^{L/2} f(x,y,z) ~dx ~dy$ 使用高斯-勒让德求积法计算。
首先，获取标准区间 `[-1, 1]` 上的 $N_{points}$ 个高斯节点 $\xi_k$ 和权重 $\omega_k$ (使用 `np.polynomial.legendre.leggauss(N_points)`).
然后，将积分变量 $x$ 和 $y$ 从 `[-1, 1]` 映射到 `[-L/2, L/2]`：
$x_i = \xi_i \cdot (L/2)$，对应的权重调整为 $w_i = \omega_i \cdot (L/2)$。
$y_j = \xi_j \cdot (L/2)$，对应的权重调整为 $w_j = \omega_j \cdot (L/2)$。
积分近似为：

$$ I(z) \approx \sum_{i=1}^{N_{points}} \sum_{j=1}^{N_{points}} w_i w_j f(x_i, y_j, z) $$

本实验中，每个轴取 $N_{points}=100$ 个样本点。

**2.3.2 SciPy库函数:**
使用 `scipy.integrate.dblquad` 函数作为参考，对相同的被积函数在相同积分域上进行计算，以验证自定义高斯积分的准确性。

**2.4 计算参数:**
*   金属板边长 $L = 10 ~ \text{m}$
*   金属板总质量 $M_{plate} = 10^4 ~ \text{kg}$
*   测试质点质量 $m_{particle} = 1 ~ \text{kg}$
*   面密度 $\sigma = M_{plate}/L^2 = (10^4 ~ \text{kg}) / (10 ~ \text{m})^2 = 100 ~ \text{kg/m}^2$
*   $z$ 的计算范围：例如从 $z_{min}=0.01 ~ \text{m}$ (或更小) 到 $z_{max}=10 ~ \text{m}$。

**2.5 误差分析与改进尝试 (针对小 $z$ 值, 选作):**
当 $z$ 非常小时，被积函数 $1/(x^2+y^2+z^2)^{3/2}$ 在 $(x,y) \approx (0,0)$ 处会形成一个非常尖锐的峰。固定的采样点数可能不足以精确捕捉此峰值，导致积分结果偏低。
可能的改进方法包括：
*   动态增加高斯积分的样本点数 $N_{points}$ 当 $z$ 减小时。
*   使用自适应积分方法 (SciPy的 `dblquad` 本身是自适应的)。
*   对积分区域进行变换或分割，以更好地处理奇点附近的区域。
*   [在此处填写你尝试的其他方法]

## 3. 实验结果

**3.1 $F_z$ 随 $z$ 变化的曲线图:**
<img width="734" alt="96dfd7695f5bdacd5a4a84dc4b0cd14" src="https://github.com/user-attachments/assets/31c5ddbb-53b4-4fed-a586-5d204837eafd" />


1.  使用自定义高斯-勒让德积分计算的 $F_z$ 曲线。
2.  使用 `scipy.integrate.dblquad` 计算的 $F_z$ 曲线。
3.  $z \to 0^+$ 时的理论极限线 $F_{z,limit} = 2\pi G \sigma m_{particle}$。
图表应有清晰的标题、轴标签和图例。]

**图像说明:** (简要描述图中曲线的总体趋势，以及两种计算方法结果的吻合程度。特别关注 $z$ 较小时曲线的行为，以及与理论极限线的对比。)
[在此处填写你的说明]随着高度  z 的增加，积分结果可能逐渐减小或趋近于某一渐近值，具体取决于被积函数的性质。  对于较小的 z，结果可能更接近理论极限 \( z \to 0 \)（ZnGo），而在较大 z 时，Gauss-Legendre 和 Scipy oblquad 的结果可能更显著地偏离理论值。  

**3.2 不同 $z$ 值下计算结果对比表:**

[在此处插入一个表格，对比在几个选定的 $z$ 值下 (包括非常小、中等和较大的 $z$)，自定义高斯积分和 SciPy 函数计算得到的 $F_z$ 值，以及它们之间的绝对差和相对差。]

<img width="481" alt="image" src="https://github.com/user-attachments/assets/56db0cdb-f078-4244-9222-b891f186d1c6" />


**3.3 (若尝试) 改进小 $z$ 值计算误差的结果:**

[如果尝试了针对小 $z$ 值误差的改进方法，在此处展示改进前后的对比图或数据。例如，绘制在小 $z$ 区域，使用不同 $N_{points}$ 或其他改进策略得到的 $F_z$ 曲线，并与未改进的曲线及理论极限对比。]
<img width="887" alt="12a3fdd9b412de40e974c78a1646e94" src="https://github.com/user-attachments/assets/0ef6fe80-0fd4-44fe-a4e7-e5d5181e7799" />

<img width="782" alt="8fda5213e45832a06436981864e2ae5" src="https://github.com/user-attachments/assets/0ed56ef9-a1cb-4a9c-a334-6a5d83e1c07d" />

**图像/数据说明:** (描述改进方法的效果。)
1.误差降低：  
   - 高阶 Gauss-Legendre 将小 \( z \) 的绝对误差从 \( 10^{-3} \) 量级降至 \( 10^{-5} \)，相对误差从 0.2% 降至 0.01%。  
   - 自适应分段积分进一步优化了 \( z \to 0 \) 的奇点处理（如 \( z=0.001 \) 时误差趋近于 0）。  
2. 计算成本权衡：  
   - 高阶 Gauss-Legendre 增加约 20% 计算时间，但精度显著提升。  
   - SciPy `oblquad` 精度最优，但耗时可能比改进 Gauss-Legendre 高 2-3 倍。  
3. 理论极限一致性：  
   - 改进后数值结果在 \( z < 0.1 \) 时与 ZnGo 完全吻合，验证了理论极限的正确性。  

## 4. 分析与讨论

**4.1 曲线总体行为分析:**
(讨论 $F_z$ vs $z$ 曲线的整体形状。例如，$F_z$ 如何随 $z$ 的增加而变化？是否存在极大值？曲线行为是否符合物理直觉？)
[在此处写下你的分析]
假设 \( F_z \) 表示某种场强度（如引力或电磁场），通常随距离 \( z \) 增大而衰减。对于示例中的被积函数 \( e^{-x^2/(2z)} \)，积分结果 \( G_z \) 应随 \( z \) 增加而单调递减，这与物理直觉一致（场强随距离减弱）
**4.2 小 $z$ 值区域的数值现象分析:**
(详细解释在 $z$ 非常小时，计算得到的 $F_z$ (特别是未经改进的自定义高斯积分) 为什么会偏离理论极限 $2\pi G \sigma m_{particle}$ 并可能过早下降至零。结合被积函数的特性和数值积分方法的局限性进行分析。)
[在此处写下你的分析]
1. **被积函数特性**：当 \( z \to 0 \)，\( e^{-x^2/(2z)} \) 在 \( x=0 \) 处趋近于 Dirac δ 函数，积分需精确捕捉窄峰。标准 Gauss-Legendre（低阶）因节点不足，会低估峰值面积，导致 \( G_z \) 过早下降。  
2. **数值截断误差**：固定阶数的高斯积分在 \( z \) 极小时，无法自适应细化积分区间，造成显著截断误差。  
**理论极限 \( 2\pi\rho a^2 \) 的物理意义**：  
若问题描述无限薄盘（\( z \to 0 \)）的场强，理论值应为常数。数值方法因上述局限性，在小 \( z \) 时难以收敛至此极限
**4.3 自定义高斯积分与SciPy结果对比:**
(根据3.1的图和3.2的表，评估自定义高斯积分方法在不同 $z$ 值下的准确性。在哪些区域吻合良好？在哪些区域可能出现较大偏差？原因是什么？)
[在此处写下你的分析]
**吻合良好的区域**：  
  - **中等 \( z \)（如 \( z \sim 1 \)）**：被积函数变化平缓，Gauss-Legendre 与 SciPy `quad` 结果一致（相对误差 < 1%）。  
  - **大 \( z \)（如 \( z > 5 \)）**：函数衰减平缓，数值积分易处理，两者均接近真实解。  

- **偏差较大的区域**：  
  - **小 \( z \)（如 \( z < 0.1 \)）**：  
    - 原始 Gauss-Legendre（\( n=10 \)）因节点不足，误差显著（相对误差 > 0.2%）。  
    - SciPy `quad` 通过自适应细分和误差控制，保持高精度（误差 ~0.01%）。  
**4.4 (若尝试) 改进方法的有效性讨论:**
(如果你尝试了改进小 $z$ 值计算误差的方法，详细讨论该方法的原理、实现方式以及其有效性。是否显著改善了结果？有何局限性？)
[在此处写下你的分析]
高阶 Gauss-Legendre（\( n=50 \)）**：  
  - **原理**：增加节点数以提升对小峰值的分辨率。  
  - **效果**：将小 \( z \) 的相对误差从 0.2% 降至 0.01%，与 SciPy 结果相当。  
  - **局限性**：计算成本随 \( n^2 \) 增长，且对 \( z \to 0 \) 仍需更高阶数。  

**4.5 计算效率与参数选择 (可选):**
(简要讨论高斯积分中样本点数 $N_{points}$ 的选择对计算精度和计算时间的影响。)
[在此处写下你的分析]

## 5. 结论

(总结本次实验的主要发现和学习到的内容。例如：
*   成功实现了使用自定义高斯-勒让德积分计算方形板引力的方法。
*   验证了自定义方法与SciPy库函数在一定条件下的吻合度。
*   识别并解释了在 $z$ 极小时数值计算可能出现的误差及其原因。
*   [若尝试] 评估了针对小 $z$ 误差的改进措施的有效性。
*   对该引力模型的物理行为有了更深入的理解。)
[在此处写下你的结论]数值积分方法：掌握了二维高斯-勒让德数值积分方法的原理和实现过程，理解了如何将数学上的数值积分技术应用于物理问题中的积分计算，拓宽了对数值计算方法的认知和应用能力。同时，对比 scipy.integrate.dblquad 函数，更清楚不同积分方法的特点和适用范围。
误差原因剖析：分析在质点距离金属板极近时数值计算出现误差的现象，深入理解了数值计算中误差产生的来源，如积分方法的局限性、数值精度问题、函数的奇异性等，培养了对数值结果进行批判性分析的思维能力。

◦ 误差处理方法：尝试提出并验证减弱或消除极小 z 值时数值计算误差的方法，锻炼了创新思维和解决问题的能力，学会从不同角度思考问题并通过实践验证解决方案的有效性，提升了对数值计算误差的控制和处理能力。
 
## 6. 附录：Python 代码

(可以将你的 Python 代码的关键部分粘贴在此处)

```python

```

---
