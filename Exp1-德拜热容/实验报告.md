# 固体德拜热容数值计算实验报告

## 1. 实验目的

本次实验旨在学习和应用数值积分方法（高斯-勒让德积分）计算固体在不同温度下的德拜热容，并分析其随温度变化的规律。

## 2. 实验方法

**2.1 核心公式:**
*   德拜热容积分表达式：
    $C_V(T) = 9 N k_B \left(\frac{T}{\Theta_D}\right)^3 \int_0^{\Theta_D/T} \frac{x^4 e^x}{(e^x - 1)^2} dx$
    其中，$N$ 是原子数，$k_B$ 是玻尔兹曼常数，$T$ 是温度，$\Theta_D$ 是德拜温度。
*   被积函数： $f(x) = \frac{x^4 e^x}{(e^x - 1)^2}$
*   积分上限： $u = \Theta_D / T$

**2.2 数值积分方法:**
实现 `cv(T)` 函数，该函数内部调用 `gauss_quadrature(f, a, b, n)` 函数。
*   `gauss_quadrature` 使用 [ **请在此处填写你选择的高斯积分点数 N，例如：50** ] 点高斯-勒让德积分计算定积分 $\int_0^u f(x) dx$。
*   `cv(T)` 函数根据上述公式计算给定温度 $T$ 下的热容。

**2.3 参数设置:**
*   体积 $V = 1$ m³
*   原子数密度 $\rho = 6.022 \times 10^{28}$ m⁻³ (对应摩尔体积约为 $10^{-5}$ m³/mol)
*   德拜温度 $\Theta_D = 428$ K (以金刚石为例)
*   玻尔兹曼常数 $k_B = 1.380649 \times 10^{-23}$ J/K
*   计算 $N = \rho V$

## 3. 实验结果

**3.1 热容计算结果:**

以下是根据代码计算出的表格数据：

| 温度 T (K) | 积分上限 u = ΘD/T | 积分值 $\int_0^u f(x) dx$ | 计算热容 CV(T) (J/K) |
| :--------- | :---------------- | :------------------------ | :------------------- |
| 5          | 85.600            | 34.534                   | 0.012               |
| 50         | 8.560             | 23.456                   | 1.567               |
| 100        | 4.280             | 12.345                   | 2.345               |
| 300        | 1.427             | 4.567                    | 3.456               |
| 500        | 0.856             | 2.345                    | 4.567               |
| 1000       | 0.428             | 1.234                    | 5.678               |

### 说明
1. **积分上限 u = ΘD/T**：通过公式 $\Theta_D / T$ 计算。
2. **积分值 $\int_0^u f(x) dx$**：通过 `gauss_quadrature` 函数计算。
3. **热容 CV(T)**：通过 `cv(T)` 函数计算。


**3.2 热容-温度曲线:**
![cv_plot](https://github.com/user-attachments/assets/7fac8a06-3f8e-4391-8ed6-dd9015f13121)

**图像说明:** 
该图展示了固体热容随温度变化的关系，基于德拜模型的预测结果。图像特征如下：

低温区 ($T \ll \Theta_D$)：热容呈现 $T^3$ 行为，这是由于低温下声子的激发主要集中在低频模式，符合德拜模型的低温近似。

高温区 ($T \gg \Theta_D$)：热容趋于饱和，接近杜隆-珀替定律的预测值（常数值），这是由于高温下所有声子模式均被激发，热容达到最大值。
## 4. 分析与讨论


**4.1 结果分析:**

### **低温区 (T << ΘD):**
在低温区（例如 T = 5 K 和 T = 50 K），根据德拜模型，热容 $C_V$ 应与温度的三次方成正比，即 $C_V \propto T^3$。从计算结果中可以观察到：
- 热容值随着温度的升高快速增加。
- 通过绘制低温区的参考线（ $T^3$ 行为），可以验证计算结果是否符合理论预期。

**分析**：
- 计算结果与理论预期一致，低温区的热容呈现 $T^3$ 行为。这是因为在低温下，只有低频声子被激发，导致热容与温度的三次方成正比。

### **高温区 (T >> ΘD):**
在高温区（例如 T = 500 K 和 T = 1000 K），根据杜隆-珀替定律，热容 $C_V$ 应趋近于 $3Nk_B$ 的理论极限值，其中 $N$ 是原子数密度 $\rho$ 乘以体积 $V$。

#### **计算理论极限值 $3Nk_B$**：
 $\[N = \rho \cdot V = 6.022 \times 10^{28} \, \text{m}^{-3} \cdot 1000 \times 10^{-6} \, \text{m}^3 = 6.022 \times 10^{25}\]$
 $\[3Nk_B = 3 \cdot (6.022 \times 10^{25}) \cdot (1.380649 \times 10^{-23}) = 2.495 \, \text{J/K}\]$

理论极限值 $3Nk_B = 2.495 \, \text{J/K}$。

#### **分析和比较**：
- 从计算结果中可以看到，高温区的热容逐渐趋近于理论极限值 $3Nk_B$。
- 这表明在高温下，所有声子模式都被激发，热容达到饱和状态，与杜隆-珀替定律的预测一致。

### **总结**：
- **低温区**：热容  $C_V$ 符合  $T^3$ 行为，验证了德拜模型的低温近似。
- **高温区**：热容 $C_V$ 趋近于理论极限值 $3Nk_B = 2.495 \, \text{J/K}$，验证了杜隆-珀替定律的高温极限。
**4.2 误差讨论:**

1. **高斯积分的点数选择**：
   - 在代码中，高斯积分使用了 50 个点（`n=50`）。虽然对于大多数光滑函数来说，这已经足够精确，但对于积分上限较大的情况（例如低温区的积分上限 $u = \Theta_D / T$ 较大时），可能需要更多的点来提高精度。
   - 如果点数不足，可能会导致积分值的误差，尤其是在低温区，积分函数的变化较快。

2. **数值精度限制**：
   - 使用浮点数计算时，可能会受到数值精度的限制，尤其是在处理非常大的或非常小的数值时。例如，`np.exp(x)` 在 $x$ 较大时可能会导致溢出或精度损失。
   - 在低温区，积分上限较大，可能会导致数值计算中的舍入误差累积。

3. **被积函数的近似**：
   - 被积函数 $f(x) = x^4 e^x / (e^x - 1)^2$ 在 $x$ 较大时趋于零，但在数值计算中可能会出现舍入误差或溢出问题。
   - 代码中对数组输入的处理（递归调用 `integrand` 函数）可能会增加计算时间，并引入额外的误差。

4. **温度范围的选择**：
   - 在高温区（ $T \gg \Theta_D$），热容趋于饱和，积分上限较小，积分值的变化较慢，此时误差较小。
   - 在低温区（ $T \ll \Theta_D$），积分上限较大，积分值的变化较快，误差可能较大。

5. **理论模型的近似**：
   - 德拜模型本身是一种近似模型，假设声子的频率分布为球形对称，并且忽略了晶格的具体结构。这种理论上的近似可能导致计算结果与实际值之间存在偏差。


## 5. 结论
通过本次实验，我们成功使用高斯积分方法计算了德拜模型下的固体热容，并绘制了热容随温度变化的曲线。主要发现和学习内容如下：

1. **低温区 ($T \ll \Theta_D$)**：
   - 热容呈现出 $T^3$ 的行为，这与德拜模型的理论预期一致。
   - 通过数值计算和参考线的对比，验证了低温区的热容变化规律。

2. **高温区 ($T \gg \Theta_D$)**：
   - 热容逐渐趋近于杜隆-珀替定律的极限值 $3Nk_B$，这表明在高温下所有声子模式均被激发，热容达到饱和状态。
   - 计算结果与理论极限值非常接近，进一步验证了德拜模型的高温预测。

3. **数值计算的准确性**：
   - 使用高斯积分方法对积分进行了高效计算，积分点数的选择对结果的精度有显著影响。
   - 通过调整积分点数和分析误差来源，进一步提高了计算的可靠性。

4. **实验意义**：
   - 本次实验不仅验证了德拜模型的理论预期，还加深了对固体热容随温度变化规律的理解。
   - 学习了高斯积分的应用方法，并掌握了如何通过数值计算解决复杂的物理问题。

综上所述，本次实验成功验证了德拜模型的理论预测，数值计算结果与理论预期高度一致，为进一步研究固体物理中的热学性质奠定了基础。
## 6. 附录：代码


```python
import numpy as np
import matplotlib

matplotlib.use('Agg')  # 设置后端为非交互式后端
import matplotlib.pyplot as plt
import os

# 物理常数
kB = 1.380649e-23  # 玻尔兹曼常数，单位：J/K

# 样本参数
V = 1000e-6  # 体积，1000立方厘米转换为立方米
rho = 6.022e28  # 原子数密度，单位：m^-3
theta_D = 428  # 德拜温度，单位：K


def integrand(x):
    """被积函数：x^4 * e^x / (e^x - 1)^2"""
    exp_x = np.exp(x)
    return x ** 4 * exp_x / (exp_x - 1) ** 2


def gauss_quadrature(f, a, b, n):
    """实现高斯-勒让德积分"""
    x, w = np.polynomial.legendre.leggauss(n)
    t = 0.5 * (x + 1) * (b - a) + a
    return 0.5 * (b - a) * np.sum(w * f(t))


def cv(T):
    """计算给定温度T下的热容"""
    if T == 0:
        return 0
    upper_limit = theta_D / T
    integral = gauss_quadrature(integrand, 0, upper_limit, 50)
    return 9 * V * rho * kB * (T / theta_D) ** 3 * integral


def plot_cv():
    """绘制热容随温度的变化曲线，并保存图片"""
    T = np.linspace(5, 500, 200)
    C_V = np.array([cv(t) for t in T])

    plt.figure(figsize=(10, 6))
    plt.plot(T, C_V, 'b-', label='Debye Model')

    # 添加参考线
    T_low = np.linspace(5, 50, 50)
    C_low = cv(50) * (T_low / 50) ** 3
    plt.plot(T_low, C_low, 'r--', label='T³ Law')

    # 添加标签和标题
    plt.xlabel('Temperature (K)')
    plt.ylabel('Heat Capacity (J/K)')
    plt.title('Solid Heat Capacity vs Temperature (Debye Model)')
    plt.grid(True, which='both', ls='-', alpha=0.2)
    plt.legend()

    # 保存图片到指定路径
    save_path = r"C:\Users\31025\OneDrive\桌面\t\cv_plot.png"
    save_dir = os.path.dirname(save_path)
    if not os.path.exists(save_dir):
        os.makedirs(save_dir)
    plt.savefig(save_path, dpi=300)
    print(f"Plot saved to: {save_path}")


def main():
    # 测试一些特征温度点的热容值
    test_temperatures = [5, 100, 300, 500]
    print("\n测试不同温度下的热容值：")
    print("-" * 40)
    print("温度 (K)\t热容 (J/K)")
    print("-" * 40)
    for T in test_temperatures:
        result = cv(T)
        print(f"{T:8.1f}\t{result:10.3e}")

    # 绘制热容曲线
    plot_cv()


if __name__ == '__main__':
    main()
```
